(define-namespace 'free (sig-keyset) (sig-keyset))
(env-data 
    { 'ns: 'free 
    , "user1" : ["user1-keys"]
    }
)

(load "../src/lib-3x2.repl")

(define-keyset "free.opact-admin" (read-keyset "user1"))

(env-gasmodel "table")
(env-gaslimit 150000)
(env-gas 0)

(expect "verify" {"paired": true} (verify 
    {
        "public_values":[5097715052237145403753365704898254467169137625210256492956965949270430045 10350054029334029104721836436197614298271599814974025951759768887472959204491 8880212327543797734391566362872821399417931236479047492409675925327395362024 6744756488845918878339475731082062348289674403192928430312475229224416054163 11447887161685273325229383682033758855034454108223333399257174474224042460477 20085879863141481154416816762505004939695895115007481593493468713550477118072 1491673331617618272981045375721765540778861924763498414377149116092375404182 1409566157580977860959833662881925553878710509003 1076349462536313652575937474535332016951960024124 814843937149388495664711784579302082226637396667434303269754721330180190802],
        "a":{"x":17901042678392254749009477662444348028409443811053697007027715576663992903799,"y":17048225545256157163674902826671998880176775729930869352951888784634602972577},
        "b":{"x":[4434085511194832277146281817017632276264964685517905758544892252867374596754 18032823362937264937199773264971671344432187031187091034703593895639367647694],
             "y":[9439696666055659947675970120722790572303540575063261557626202383522078275740 20091390898922485508524257678012892745061123293603606701407411013078735614039]},
        "c":{"x":17910219481298589721088687155746307889801437978994146636715821557888886556540,"y":3644328300856086571465919298625535607457024633955676512087523130907764371638}
    }
))

(print {"Total gas": (env-gas)})
(env-gas 0)

(expect "verify" {"paired": true} (verify 
    {
        "public_values":[6549528558437796551109796215651469590577289298285154522446750263957848217990 9340507213909893570075533458249420519277410455902050647058477812654729690871 3836484959209379530897253280930481664044991636501750449284507664334663619803 3310042387063546051694339821566389833437850998173760495616000858241156362449 13924262072728720917501484489183006849613902356672750964253617819963275417535 17331021142945595148003703207469365834071507571641831262582918266535631794863 7486776175838865209771455585678644242478266678596657713703262325949588930608 1454133245195396932460760613671278372813553831461 1200174454565686355742945407856392826315842700977 4592424182211517880640117801487621447541670828836116903220358463876373231471],
        "a":{"x":12164292933485601233815401389865865768076956758778525696943986049330812280811,"y":148156805490929500155342626819885615932831719484138700821655809730274224518},
        "b":{"x":[8565763447153129650963651970913324634102820393585688003808392088532410551486 4057642463456610909530169451152346322741370436053630738073125029089918919051],
            "y":[5139674024656230324954454149962948460713552941439408421556823687316849103099 2787615627075675709229748956401315674998600271044382362867289040397766488473]},
        "c":{"x":11973567014970121358007049185582855204989331702222051249273563650100952584514,"y":12157157589678748850774352572000384256255550701141155806931747671010347592989}
    }
))

(print {"Total gas": (env-gas)})
(env-gas 0)

(expect "verify" {"paired": false} (verify 
    {
        "public_values":[6549528558437796551109796215651469590577289298285154522446750263957848217990 9340507213909893570075533458249420519277410455902050647058477812654729690871 3836484959209379530897253280930481664044991636501750449284507664334663619803 3310042387063546051694339821566389833437850998173760495616000858241156362449 13924262072728720917501484489183006849613902356672750964253617819963275417535 17331021142945595148003703207469365834071507571641831262582918266535631794863 7486776175838865209771455585678644242478266678596657713703262325949588930608 1454133245195396932460760613671278372813553831461 1200174454565686355742945407856392826315842700977 4592424182211517880640117801487621447541670828836116903220358463876373231471],
        "a":{"x":19817713765959346549871130524470948269519566174538742939036152399142416600582,"y":20982929616821238786000656044488294849631590234739190402911135613417078219455},
        "b":{"x":[8586005240412506756232549016262713541937049887946846965391911108745443737983 9587493727140983135209670127248213932838995815439324182670188972155479051173],
        "y":[3304759387246915019533575974791000179823243043816637947321468390345277807091 10323717147005767368120555592716346202516177652934252937639685195636233739862]},
        "c":{"x":4016739862039177466188094288526125375400410920627291835204997875349870930371,"y":8109450981714180662240853592027233497894520695072849576218650369542745992730}
    }
))

(print {"Total gas": (env-gas)})
